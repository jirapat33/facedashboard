<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Face Scan Dashboard</title>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

<style>
body {
  font-family: Arial;
  padding: 20px;
  background: #111;
  color: white;
}

table {
  border-collapse: collapse;
  width: 100%;
  background: #222;
}

td, th {
  border: 1px solid #444;
  padding: 8px;
}

th {
  background: #333;
}

input, button {
  padding: 8px;
  font-size: 16px;
}
</style>
</head>

<body>

<!-- ‚úÖ LOGIN BOX -->
<div id="loginBox">
  <h2>üîê Login Dashboard</h2>
  <input id="email" placeholder="email"><br><br>
  <input id="password" type="password" placeholder="password"><br><br>
  <button onclick="login()">Login</button>
</div>

<!-- ‚úÖ DASHBOARD -->
<div id="dashboard" style="display:none;">

<h1>üì∑ Face Scan Dashboard</h1>

<button onclick="logout()">Logout</button>

<br><br>

<table>
<thead>
<tr>
<th>‡πÄ‡∏ß‡∏•‡∏≤</th>
<th>‡∏ä‡∏∑‡πà‡∏≠</th>
<th>Score</th>
<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
</tr>
</thead>

<tbody id="logTable"></tbody>
</table>

</div>

<script>

const firebaseConfig = {
  apiKey: "AIzaSyC_HoCxNTNkT0lwLnhFo2XhhL9ZsaJyJsE",
  authDomain: "face-c21b8.firebaseapp.com",
  databaseURL: "https://face-c21b8-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "face-c21b8",
  storageBucket: "face-c21b8.firebasestorage.app",
  messagingSenderId: "757987663456",
  appId: "1:757987663456:web:a098ca97ba7f45bb826d05"
};

firebase.initializeApp(firebaseConfig);

const db = firebase.database();
const auth = firebase.auth();


// ---------------------
// LOGIN
// ---------------------
function login(){
  const email = document.getElementById("email").value;
  const pass = document.getElementById("password").value;

  auth.signInWithEmailAndPassword(email, pass)
    .catch(e=>alert(e.message));
}

function logout(){
  auth.signOut();
}

// ---------------------
// AUTH STATE
// ---------------------
auth.onAuthStateChanged(user=>{
  if(user){
    loginBox.style.display="none";
    dashboard.style.display="block";
    startRealtime();
  } else {
    loginBox.style.display="block";
    dashboard.style.display="none";
  }
});


// ---------------------
// REALTIME LOAD
// ---------------------
function startRealtime(){

  db.ref("scan_logs")
    .limitToLast(100)
    .on("child_added", snap => {

      const data = snap.val();

      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td>${data.time}</td>
        <td>${data.name}</td>
        <td>${data.score?.toFixed(2)}</td>
        <td>${data.date}</td>
      `;

      document.getElementById("logTable").prepend(tr);
  });
}

</script>

</body>
</html>
